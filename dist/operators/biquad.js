"use strict";

var _classCallCheck = require("babel-runtime/helpers/class-call-check")["default"];

var _inherits = require("babel-runtime/helpers/inherits")["default"];

var _get = require("babel-runtime/helpers/get")["default"];

var _createClass = require("babel-runtime/helpers/create-class")["default"];

var _core = require("babel-runtime/core-js")["default"];

/**
 * @fileoverview WAVE LFO module: biquad filter.
 * @author Jean-Philippe.Lambert@ircam.fr, Norbert.Schnell@ircam.fr, victor.saiz@ircam.fr
 * @version 0.1.0
 *
 * @brief  Biquad filter and coefficients calculator
 *
 * Based on the "Cookbook formulae for audio EQ biquad filter
 * coefficients" by Robert Bristow-Johnson
 *
 */

/* y(n) = b0 x(n) + b1 x(n-1) + b2 x(n-2)  */
/*                - a1 x(n-1) - a2 x(n-2)  */

/* f0 is normalised by the nyquist frequency */
/* q must be > 0. */
/* gain must be > 0. and is linear */

/* when there is no gain parameter, one can simply multiply the b
 * coefficients by a (linear) gain */

/* a0 is always 1. as each coefficient is normalised by a0, including a0 */

/* a1 is a[0] and a2 is a[1] */

var _require = require("../core/lfo-base");

var Lfo = _require.Lfo;

var sin = Math.sin;
var cos = Math.cos;
var M_PI = Math.PI;
var sqrt = Math.sqrt;

// coefs calculations
// ------------------

/* LPF: H(s) = 1 / (s^2 + s/Q + 1) */
function lowpass_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = (1 - c) * 0.5 * a0_inv;
  coefs.b1 = (1 - c) * a0_inv;
  coefs.b2 = coefs.b0;
}

/* HPF: H(s) = s^2 / (s^2 + s/Q + 1) */
function highpass_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = (1 + c) * 0.5 * a0_inv;
  coefs.b1 = (-1 - c) * a0_inv;
  coefs.b2 = coefs.b0;
}

/* BPF: H(s) = s / (s^2 + s/Q + 1)  (constant skirt gain, peak gain = Q) */
function bandpass_constant_skirt_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var s = sin(w0);
  var alpha = s / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = s * 0.5 * a0_inv;
  coefs.b1 = 0;
  coefs.b2 = -coefs.b0;
}

/* BPF: H(s) = (s/Q) / (s^2 + s/Q + 1)      (constant 0 dB peak gain) */
function bandpass_constant_peak_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = alpha * a0_inv;
  coefs.b1 = 0;
  coefs.b2 = -coefs.b0;
}

/* notch: H(s) = (s^2 + 1) / (s^2 + s/Q + 1) */
function notch_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = a0_inv;
  coefs.b1 = coefs.a1;
  coefs.b2 = coefs.b0;
}

/* APF: H(s) = (s^2 - s/Q + 1) / (s^2 + s/Q + 1) */
function allpass_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = coefs.a2;
  coefs.b1 = coefs.a1;
  coefs.b2 = 1;
}

/* peakingEQ: H(s) = (s^2 + s*(A/Q) + 1) / (s^2 + s/(A*Q) + 1) */
/* A = sqrt( 10^(dBgain/20) ) = 10^(dBgain/40) */
/* gain is linear here */
function peaking_coefs(f0, q, gain, coefs) {

  var g = sqrt(gain);
  var g_inv = 1 / g;

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha * g_inv);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha * g_inv) * a0_inv;

  coefs.b0 = (1 + alpha * g) * a0_inv;
  coefs.b1 = coefs.a1;
  coefs.b2 = (1 - alpha * g) * a0_inv;
}

/* lowShelf: H(s) = A * (s^2 + (sqrt(A)/Q)*s + A)/(A*s^2 + (sqrt(A)/Q)*s + 1) */
/* A = sqrt( 10^(dBgain/20) ) = 10^(dBgain/40) */
/* gain is linear here */
function lowshelf_coefs(f0, q, gain, coefs) {

  var g = sqrt(gain);

  var w0 = M_PI * f0;
  var alpha_2_sqrtg = sin(w0) * sqrt(g) / q;
  var c = cos(w0);

  var a0_inv = 1 / (g + 1 + (g - 1) * c + alpha_2_sqrtg);

  coefs.a1 = -2 * (g - 1 + (g + 1) * c) * a0_inv;
  coefs.a2 = (g + 1 + (g - 1) * c - alpha_2_sqrtg) * a0_inv;

  coefs.b0 = g * (g + 1 - (g - 1) * c + alpha_2_sqrtg) * a0_inv;
  coefs.b1 = 2 * g * (g - 1 - (g + 1) * c) * a0_inv;
  coefs.b2 = g * (g + 1 - (g - 1) * c - alpha_2_sqrtg) * a0_inv;
}

/* highShelf: H(s) = A * (A*s^2 + (sqrt(A)/Q)*s + 1)/(s^2 + (sqrt(A)/Q)*s + A) */
/* A = sqrt( 10^(dBgain/20) ) = 10^(dBgain/40) */
/* gain is linear here */
function highshelf_coefs(f0, q, gain, coefs) {

  var g = sqrt(gain);

  var w0 = M_PI * f0;
  var alpha_2_sqrtg = sin(w0) * sqrt(g) / q;
  var c = cos(w0);

  var a0_inv = 1 / (g + 1 - (g - 1) * c + alpha_2_sqrtg);

  coefs.a1 = 2 * (g - 1 - (g + 1) * c) * a0_inv;
  coefs.a2 = (g + 1 - (g - 1) * c - alpha_2_sqrtg) * a0_inv;

  coefs.b0 = g * (g + 1 + (g - 1) * c + alpha_2_sqrtg) * a0_inv;
  coefs.b1 = -2 * g * (g - 1 + (g + 1) * c) * a0_inv;
  coefs.b2 = g * (g + 1 + (g - 1) * c - alpha_2_sqrtg) * a0_inv;
}

/* helper */
function calculateCoefs(type, f0, q, gain, coefs) {

  switch (type) {
    case "lowpass":
      lowpass_coefs(f0, q, coefs);
      break;

    case "highpass":
      highpass_coefs(f0, q, coefs);
      break;

    case "bandpass_constant_skirt":
      bandpass_constant_skirt_coefs(f0, q, coefs);
      break;

    case "bandpass_constant_peak":
      bandpass_constant_peak_coefs(f0, q, coefs);
      break;

    case "notch":
      notch_coefs(f0, q, coefs);
      break;

    case "allpass":
      allpass_coefs(f0, q, coefs);
      break;

    case "peaking":
      peaking_coefs(f0, q, gain, coefs);
      break;

    case "lowshelf":
      lowshelf_coefs(f0, q, gain, coefs);
      break;

    case "highshelf":
      highshelf_coefs(f0, q, gain, coefs);
      break;
  }

  switch (type) {
    case "lowpass":
    case "highpass":
    case "bandpass_constant_skirt":
    case "bandpass_constant_peak":
    case "notch":
    case "allpass":

      if (gain != 1) {
        coefs.b0 *= gain;
        coefs.b1 *= gain;
        coefs.b2 *= gain;
      }

      break;

    /* gain is already integrated for the following */
    case "peaking":
    case "lowshelf":
    case "highshelf":
      break;
  }
}

/* direct form I */
/* a0 = 1, a1 = a[0], a2 = a[1] */
/* 4 states (in that order): x(n-1), x(n-2), y(n-1), y(n-2)  */
function biquadArrayDf1(coefs, state, inFrame, outFrame, size) {
  for (var i = 0; i < size; i++) {
    var y = coefs.b0 * inFrame[i] + coefs.b1 * state.xn_1[i] + coefs.b2 * state.xn_2[i] - coefs.a1 * state.yn_1[i] - coefs.a2 * state.yn_2[i];

    outFrame[i] = y;

    // update states
    state.xn_2[i] = state.xn_1[i];
    state.xn_1[i] = inFrame[i];

    state.yn_2[i] = state.yn_1[i];
    state.yn_1[i] = y;
  }
}

/* transposed direct form II */
/* a0 = 1, a1 = a[0], a2 = a[1] */
/* 2 states */
function biquadArrayDf2(coefs, state, inFrame, outFrame, size) {
  for (var i = 0; i < size; i++) {
    outFrame[i] = coefs.b0 * inFrame[i] + state.xn_1[i];

    // update states
    state.xn_1[i] = coefs.b1 * inFrame[i] - coefs.a1[i] * outFrame[i] + state.xn_2[i];
    state.xn_2[i] = coefs.b2 * inFrame[i] - coefs.a2[i] * outFrame[i];
  }
}

var Biquad = (function (_Lfo) {
  function Biquad(previous, options) {
    _classCallCheck(this, Biquad);

    var defaults = {
      filterType: "lowpass",
      f0: 1,
      gain: 1,
      q: 1
    };

    _get(_core.Object.getPrototypeOf(Biquad.prototype), "constructor", this).call(this, previous, options, defaults);
    this.type = "biquad";

    // from here on options is this.params

    // to implement
    // if(opts.damp) …
    // if(opts.decay) …
    // if(opts.over) …

    var frameRate = this.streamParams.frameRate;
    // if no frameRate or framerate is 0 we shall halt!
    if (!frameRate || frameRate <= 0) throw new Error("This Operator requires a frameRate higher than 0.");

    var normF0 = this.params.f0 / frameRate,
        gain = this.params.gain,
        q;

    if (this.params.q) q = this.params.q;
    if (this.params.bw) q = this.params.f0 / this.params.bw;

    this.coefs = {
      b0: 0,
      b1: 0,
      b2: 0,
      a1: 0,
      a2: 0
    };

    var frameSize = this.streamParams.frameSize;
    this.state = {
      xn_1: new Float32Array(frameSize),
      xn_2: new Float32Array(frameSize),
      yn_1: new Float32Array(frameSize),
      yn_2: new Float32Array(frameSize)
    };

    calculateCoefs(this.params.filterType, normF0, q, gain, this.coefs);
    this.setupStream();
  }

  _inherits(Biquad, _Lfo);

  _createClass(Biquad, {
    process: {
      value: function process(time, frame) {
        biquadArrayDf1(this.coefs, this.state, frame, this.outFrame, frame.length);
        this.output(time);
      }
    }
  });

  return Biquad;
})(Lfo);

function factory(previous, options) {
  return new Biquad(previous, options);
}
factory.Biquad = Biquad;

module.exports = factory;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVzNi9zb3VyY2VzL3Byb2Nlc3Mtd29ya2VyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2VBNEJjLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQzs7SUFBbkMsR0FBRyxZQUFILEdBQUc7O0FBRVQsSUFBSSxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQztBQUNuQixJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDO0FBQ25CLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUM7QUFDbkIsSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQzs7Ozs7O0FBTXJCLFNBQVMsYUFBYSxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFOztBQUVqQyxNQUFJLEVBQUUsR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFDO0FBQ25CLE1BQUksS0FBSyxHQUFHLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFHLEdBQUcsQ0FBQyxDQUFBLEFBQUMsQ0FBQztBQUNoQyxNQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7O0FBRWhCLE1BQUksTUFBTSxHQUFHLENBQUcsSUFBSSxDQUFHLEdBQUcsS0FBSyxDQUFBLEFBQUMsQ0FBQzs7QUFFakMsT0FBSyxDQUFDLEVBQUUsR0FBRyxBQUFDLENBQUMsQ0FBRyxHQUFHLENBQUMsR0FBSSxNQUFNLENBQUM7QUFDL0IsT0FBSyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUcsR0FBRyxLQUFLLENBQUEsR0FBSSxNQUFNLENBQUM7O0FBRWxDLE9BQUssQ0FBQyxFQUFFLEdBQUcsQUFBQyxDQUFDLENBQUcsR0FBRyxDQUFDLENBQUEsR0FBSSxHQUFHLEdBQUksTUFBTSxDQUFDO0FBQ3RDLE9BQUssQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFHLEdBQUcsQ0FBQyxDQUFBLEdBQUksTUFBTSxDQUFDO0FBQzlC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USxFQUFFLE9BQU8sRUFBRTtBQUNsQyxTQUFPLElBQUksTUFBTSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztDQUN0QztBQUNELE9BQU8sQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDOztBQUV4QixNQUFNLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyIsImZpbGUiOiJlczYvc291cmNlcy9wcm9jZXNzLXdvcmtlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgV0FWRSBMRk8gbW9kdWxlOiBiaXF1YWQgZmlsdGVyLlxuICogQGF1dGhvciBKZWFuLVBoaWxpcHBlLkxhbWJlcnRAaXJjYW0uZnIsIE5vcmJlcnQuU2NobmVsbEBpcmNhbS5mciwgdmljdG9yLnNhaXpAaXJjYW0uZnJcbiAqIEB2ZXJzaW9uIDAuMS4wXG4gKlxuICogQGJyaWVmICBCaXF1YWQgZmlsdGVyIGFuZCBjb2VmZmljaWVudHMgY2FsY3VsYXRvclxuICpcbiAqIEJhc2VkIG9uIHRoZSBcIkNvb2tib29rIGZvcm11bGFlIGZvciBhdWRpbyBFUSBiaXF1YWQgZmlsdGVyXG4gKiBjb2VmZmljaWVudHNcIiBieSBSb2JlcnQgQnJpc3Rvdy1Kb2huc29uXG4gKlxuICovXG5cbi8qIHkobikgPSBiMCB4KG4pICsgYjEgeChuLTEpICsgYjIgeChuLTIpICAqL1xuLyogICAgICAgICAgICAgICAgLSBhMSB4KG4tMSkgLSBhMiB4KG4tMikgICovXG5cbi8qIGYwIGlzIG5vcm1hbGlzZWQgYnkgdGhlIG55cXVpc3QgZnJlcXVlbmN5ICovXG4vKiBxIG11c3QgYmUgPiAwLiAqL1xuLyogZ2FpbiBtdXN0IGJlID4gMC4gYW5kIGlzIGxpbmVhciAqL1xuXG4vKiB3aGVuIHRoZXJlIGlzIG5vIGdhaW4gcGFyYW1ldGVyLCBvbmUgY2FuIHNpbXBseSBtdWx0aXBseSB0aGUgYlxuICogY29lZmZpY2llbnRzIGJ5IGEgKGxpbmVhcikgZ2FpbiAqL1xuXG4vKiBhMCBpcyBhbHdheXMgMS4gYXMgZWFjaCBjb2VmZmljaWVudCBpcyBub3JtYWxpc2VkIGJ5IGEwLCBpbmNsdWRpbmcgYTAgKi9cblxuLyogYTEgaXMgYVswXSBhbmQgYTIgaXMgYVsxXSAqL1xuXG52YXIgeyBMZm8gfSA9IHJlcXVpcmUoJy4uL2NvcmUvbGZvLWJhc2UnKTtcblxudmFyIHNpbiA9IE1hdGguc2luO1xudmFyIGNvcyA9IE1hdGguY29zO1xudmFyIE1fUEkgPSBNYXRoLlBJO1xudmFyIHNxcnQgPSBNYXRoLnNxcnQ7XG5cbiAgLy8gY29lZnMgY2FsY3VsYXRpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8qIExQRjogSChzKSA9IDEgLyAoc14yICsgcy9RICsgMSkgKi9cbmZ1bmN0aW9uIGxvd3Bhc3NfY29lZnMoZjAsIHEsIGNvZWZzKSB7XG5cbiAgICB2YXIgdzAgPSBNX1BJICogZjA7XG4gICAgdmFyIGFscGhhID0gc2luKHcwKSAvICgyLjAgKiBxKTtcbiAgICB2YXIgYyA9IGNvcyh3MCk7XG5cbiAgICB2YXIgYTBfaW52ID0gMS4wIC8gKDEuMCArIGFscGhhKTtcblxuICAgIGNvZWZzLmExID0gKC0yLjAgKiBjKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5hMiA9ICgxLjAgLSBhbHBoYSkgKiBhMF9pbnY7XG5cbiAgICBjb2Vmcy5iMCA9ICgoMS4wIC0gYykgKiAwLjUpICogYTBfaW52O1xuICAgIGNvZWZzLmIxID0gKDEuMCAtIGMpICogYTBfaW52O1xuICAgIGNvZWZzLmIyID0gY29lZnMuYjA7XG5cbiAgfVxuXG4gIC8qIEhQRjogSChzKSA9IHNeMiAvIChzXjIgKyBzL1EgKyAxKSAqL1xuZnVuY3Rpb24gaGlnaHBhc3NfY29lZnMoZjAsIHEsIGNvZWZzKSB7XG5cbiAgICB2YXIgdzAgPSBNX1BJICogZjA7XG4gICAgdmFyIGFscGhhID0gc2luKHcwKSAvICgyLjAgKiBxKTtcbiAgICB2YXIgYyA9IGNvcyh3MCk7XG5cbiAgICB2YXIgYTBfaW52ID0gMS4wIC8gKDEuMCArIGFscGhhKTtcblxuICAgIGNvZWZzLmExID0gKC0yLjAgKiBjKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5hMiA9ICgxLjAgLSBhbHBoYSkgKiBhMF9pbnY7XG5cbiAgICBjb2Vmcy5iMCA9ICgoMS4wICsgYykgKiAwLjUpICogYTBfaW52O1xuICAgIGNvZWZzLmIxID0gKC0xLjAgLSBjKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5iMiA9IGNvZWZzLmIwO1xuXG4gIH1cblxuICAvKiBCUEY6IEgocykgPSBzIC8gKHNeMiArIHMvUSArIDEpICAoY29uc3RhbnQgc2tpcnQgZ2FpbiwgcGVhayBnYWluID0gUSkgKi9cbmZ1bmN0aW9uIGJhbmRwYXNzX2NvbnN0YW50X3NraXJ0X2NvZWZzKGYwLCBxLCBjb2Vmcykge1xuXG4gICAgdmFyIHcwID0gTV9QSSAqIGYwO1xuICAgIHZhciBzID0gc2luKHcwKTtcbiAgICB2YXIgYWxwaGEgPSBzIC8gKDIuMCAqIHEpO1xuICAgIHZhciBjID0gY29zKHcwKTtcblxuICAgIHZhciBhMF9pbnYgPSAxLjAgLyAoMS4wICsgYWxwaGEpO1xuXG4gICAgY29lZnMuYTEgPSAoLTIuMCAqIGMpICogYTBfaW52O1xuICAgIGNvZWZzLmEyID0gKDEuMCAtIGFscGhhKSAqIGEwX2ludjtcblxuICAgIGNvZWZzLmIwID0gKHMgKiAwLjUpICogYTBfaW52O1xuICAgIGNvZWZzLmIxID0gMC4wO1xuICAgIGNvZWZzLmIyID0gLWNvZWZzLmIwO1xuXG4gIH1cblxuICAvKiBCUEY6IEgocykgPSAocy9RKSAvIChzXjIgKyBzL1EgKyAxKSAgICAgIChjb25zdGFudCAwIGRCIHBlYWsgZ2FpbikgKi9cbmZ1bmN0aW9uIGJhbmRwYXNzX2NvbnN0YW50X3BlYWtfY29lZnMoZjAsIHEsIGNvZWZzKSB7XG5cbiAgICB2YXIgdzAgPSBNX1BJICogZjA7XG4gICAgdmFyIGFscGhhID0gc2luKHcwKSAvICgyLjAgKiBxKTtcbiAgICB2YXIgYyA9IGNvcyh3MCk7XG5cbiAgICB2YXIgYTBfaW52ID0gMS4wIC8gKDEuMCArIGFscGhhKTtcblxuICAgIGNvZWZzLmExID0gKC0yLjAgKiBjKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5hMiA9ICgxLjAgLSBhbHBoYSkgKiBhMF9pbnY7XG5cbiAgICBjb2Vmcy5iMCA9IGFscGhhICogYTBfaW52O1xuICAgIGNvZWZzLmIxID0gMC4wO1xuICAgIGNvZWZzLmIyID0gLWNvZWZzLmIwO1xuICB9XG5cbiAgLyogbm90Y2g6IEgocykgPSAoc14yICsgMSkgLyAoc14yICsgcy9RICsgMSkgKi9cbmZ1bmN0aW9uIG5vdGNoX2NvZWZzKGYwLCBxLCBjb2Vmcykge1xuXG4gICAgdmFyIHcwID0gTV9QSSAqIGYwO1xuICAgIHZhciBhbHBoYSA9IHNpbih3MCkgLyAoMi4wICogcSk7XG4gICAgdmFyIGMgPSBjb3ModzApO1xuXG4gICAgdmFyIGEwX2ludiA9IDEuMCAvICgxLjAgKyBhbHBoYSk7XG5cbiAgICBjb2Vmcy5hMSA9ICgtMi4wICogYykgKiBhMF9pbnY7XG4gICAgY29lZnMuYTIgPSAoMS4wIC0gYWxwaGEpICogYTBfaW52O1xuXG4gICAgY29lZnMuYjAgPSBhMF9pbnY7XG4gICAgY29lZnMuYjEgPSBjb2Vmcy5hMTtcbiAgICBjb2Vmcy5iMiA9IGNvZWZzLmIwO1xuXG4gIH1cblxuICAvKiBBUEY6IEgocykgPSAoc14yIC0gcy9RICsgMSkgLyAoc14yICsgcy9RICsgMSkgKi9cbmZ1bmN0aW9uIGFsbHBhc3NfY29lZnMoZjAsIHEsIGNvZWZzKSB7XG5cbiAgICB2YXIgdzAgPSBNX1BJICogZjA7XG4gICAgdmFyIGFscGhhID0gc2luKHcwKSAvICgyLjAgKiBxKTtcbiAgICB2YXIgYyA9IGNvcyh3MCk7XG5cbiAgICB2YXIgYTBfaW52ID0gMS4wIC8gKDEuMCArIGFscGhhKTtcblxuICAgIGNvZWZzLmExID0gKC0yLjAgKiBjKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5hMiA9ICgxLjAgLSBhbHBoYSkgKiBhMF9pbnY7XG5cbiAgICBjb2Vmcy5iMCA9IGNvZWZzLmEyO1xuICAgIGNvZWZzLmIxID0gY29lZnMuYTE7XG4gICAgY29lZnMuYjIgPSAxLjA7XG5cbiAgfVxuXG4gIC8qIHBlYWtpbmdFUTogSChzKSA9IChzXjIgKyBzKihBL1EpICsgMSkgLyAoc14yICsgcy8oQSpRKSArIDEpICovXG4gIC8qIEEgPSBzcXJ0KCAxMF4oZEJnYWluLzIwKSApID0gMTBeKGRCZ2Fpbi80MCkgKi9cbiAgLyogZ2FpbiBpcyBsaW5lYXIgaGVyZSAqL1xuZnVuY3Rpb24gcGVha2luZ19jb2VmcyhmMCwgcSwgZ2FpbiwgY29lZnMpIHtcblxuICAgIHZhciBnID0gc3FydChnYWluKTtcbiAgICB2YXIgZ19pbnYgPSAxLjAgLyBnO1xuXG4gICAgdmFyIHcwID0gTV9QSSAqIGYwO1xuICAgIHZhciBhbHBoYSA9IHNpbih3MCkgLyAoMi4wICogcSk7XG4gICAgdmFyIGMgPSBjb3ModzApO1xuXG4gICAgdmFyIGEwX2ludiA9IDEuMCAvICgxLjAgKyBhbHBoYSAqIGdfaW52KTtcblxuICAgIGNvZWZzLmExID0gKC0yLjAgKiBjKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5hMiA9ICgxLjAgLSBhbHBoYSAqIGdfaW52KSAqIGEwX2ludjtcblxuICAgIGNvZWZzLmIwID0gKDEuMCArIGFscGhhICogZykgKiBhMF9pbnY7XG4gICAgY29lZnMuYjEgPSBjb2Vmcy5hMTtcbiAgICBjb2Vmcy5iMiA9ICgxLjAgLSBhbHBoYSAqIGcpICogYTBfaW52O1xuXG4gIH1cblxuICAvKiBsb3dTaGVsZjogSChzKSA9IEEgKiAoc14yICsgKHNxcnQoQSkvUSkqcyArIEEpLyhBKnNeMiArIChzcXJ0KEEpL1EpKnMgKyAxKSAqL1xuICAvKiBBID0gc3FydCggMTBeKGRCZ2Fpbi8yMCkgKSA9IDEwXihkQmdhaW4vNDApICovXG4gIC8qIGdhaW4gaXMgbGluZWFyIGhlcmUgKi9cbmZ1bmN0aW9uIGxvd3NoZWxmX2NvZWZzKGYwLCBxLCBnYWluLCBjb2Vmcykge1xuXG4gICAgdmFyIGcgPSBzcXJ0KGdhaW4pO1xuXG4gICAgdmFyIHcwID0gTV9QSSAqIGYwO1xuICAgIHZhciBhbHBoYV8yX3NxcnRnID0gc2luKHcwKSAqIHNxcnQoZykgLyBxIDtcbiAgICB2YXIgYyA9IGNvcyh3MCk7XG5cbiAgICB2YXIgYTBfaW52ID0gMS4wIC8gKCAoZysxLjApICsgKGctMS4wKSAqIGMgKyBhbHBoYV8yX3NxcnRnKTtcblxuICAgIGNvZWZzLmExID0gKC0yLjAgKiAgICAgKCAoZy0xLjApICsgKGcrMS4wKSAqIGMgICAgICAgICAgICAgICAgKSApICogYTBfaW52O1xuICAgIGNvZWZzLmEyID0gKCAgICAgICAgICAgICAoZysxLjApICsgKGctMS4wKSAqIGMgLSBhbHBoYV8yX3NxcnRnICApICogYTBfaW52O1xuXG4gICAgY29lZnMuYjAgPSAoICAgICAgIGcgKiAoIChnKzEuMCkgLSAoZy0xLjApICogYyArIGFscGhhXzJfc3FydGcpICkgKiBhMF9pbnY7XG4gICAgY29lZnMuYjEgPSAoIDIuMCAqIGcgKiAoIChnLTEuMCkgLSAoZysxLjApICogYyAgICAgICAgICAgICAgICApICkgKiBhMF9pbnY7XG4gICAgY29lZnMuYjIgPSAoICAgICAgIGcgKiAoIChnKzEuMCkgLSAoZy0xLjApICogYyAtIGFscGhhXzJfc3FydGcpICkgKiBhMF9pbnY7XG5cbiAgfVxuXG4gIC8qIGhpZ2hTaGVsZjogSChzKSA9IEEgKiAoQSpzXjIgKyAoc3FydChBKS9RKSpzICsgMSkvKHNeMiArIChzcXJ0KEEpL1EpKnMgKyBBKSAqL1xuICAvKiBBID0gc3FydCggMTBeKGRCZ2Fpbi8yMCkgKSA9IDEwXihkQmdhaW4vNDApICovXG4gIC8qIGdhaW4gaXMgbGluZWFyIGhlcmUgKi9cbmZ1bmN0aW9uIGhpZ2hzaGVsZl9jb2VmcyhmMCwgcSwgZ2FpbiwgY29lZnMpIHtcblxuICAgIHZhciBnID0gc3FydChnYWluKTtcblxuICAgIHZhciB3MCA9IE1fUEkgKiBmMDtcbiAgICB2YXIgYWxwaGFfMl9zcXJ0ZyA9IHNpbih3MCkgKiBzcXJ0KGcpIC8gcSA7XG4gICAgdmFyIGMgPSBjb3ModzApO1xuXG4gICAgdmFyIGEwX2ludiA9IDEuMCAvICggKGcrMS4wKSAtIChnLTEuMCkgKiBjICsgYWxwaGFfMl9zcXJ0Zyk7XG5cbiAgICBjb2Vmcy5hMSA9ICggMi4wICogICAgICggKGctMS4wKSAtIChnKzEuMCkgKiBjICAgICAgICAgICAgICAgICkgKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5hMiA9ICggICAgICAgICAgICAgKGcrMS4wKSAtIChnLTEuMCkgKiBjIC0gYWxwaGFfMl9zcXJ0ZyAgKSAqIGEwX2ludjtcblxuICAgIGNvZWZzLmIwID0gKCAgICAgIGcgKiAoICAoZysxLjApICsgKGctMS4wKSAqIGMgKyBhbHBoYV8yX3NxcnRnKSApICogYTBfaW52O1xuICAgIGNvZWZzLmIxID0gKC0yLjAgKiBnICogKCAoZy0xLjApICsgKGcrMS4wKSAqIGMgICAgICAgICAgICAgICAgKSApICogYTBfaW52O1xuICAgIGNvZWZzLmIyID0gKCAgICAgIGcgKiAoICAoZysxLjApICsgKGctMS4wKSAqIGMgLSBhbHBoYV8yX3NxcnRnKSApICogYTBfaW52O1xuXG4gIH1cblxuICAvKiBoZWxwZXIgKi9cbmZ1bmN0aW9uIGNhbGN1bGF0ZUNvZWZzKHR5cGUsIGYwLCBxLCBnYWluLCBjb2Vmcykge1xuXG4gICAgc3dpdGNoKHR5cGUpIHtcbiAgICAgIGNhc2UgJ2xvd3Bhc3MnOlxuICAgICAgICBsb3dwYXNzX2NvZWZzKGYwLCBxLCBjb2Vmcyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdoaWdocGFzcyc6XG4gICAgICAgIGhpZ2hwYXNzX2NvZWZzKGYwLCBxLCBjb2Vmcyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdiYW5kcGFzc19jb25zdGFudF9za2lydCc6XG4gICAgICAgIGJhbmRwYXNzX2NvbnN0YW50X3NraXJ0X2NvZWZzKGYwLCBxLCBjb2Vmcyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdiYW5kcGFzc19jb25zdGFudF9wZWFrJzpcbiAgICAgICAgYmFuZHBhc3NfY29uc3RhbnRfcGVha19jb2VmcyhmMCwgcSwgY29lZnMpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnbm90Y2gnOlxuICAgICAgICBub3RjaF9jb2VmcyhmMCwgcSwgY29lZnMpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnYWxscGFzcyc6XG4gICAgICAgIGFsbHBhc3NfY29lZnMoZjAsIHEsIGNvZWZzKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ3BlYWtpbmcnOlxuICAgICAgICBwZWFraW5nX2NvZWZzKGYwLCBxLCBnYWluLCBjb2Vmcyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdsb3dzaGVsZic6XG4gICAgICAgIGxvd3NoZWxmX2NvZWZzKGYwLCBxLCBnYWluLCBjb2Vmcyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdoaWdoc2hlbGYnOlxuICAgICAgICBoaWdoc2hlbGZfY29lZnMoZjAsIHEsIGdhaW4sIGNvZWZzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgc3dpdGNoKHR5cGUpIHtcbiAgICAgIGNhc2UgJ2xvd3Bhc3MnOlxuICAgICAgY2FzZSAnaGlnaHBhc3MnOlxuICAgICAgY2FzZSAnYmFuZHBhc3NfY29uc3RhbnRfc2tpcnQnOlxuICAgICAgY2FzZSAnYmFuZHBhc3NfY29uc3RhbnRfcGVhayc6XG4gICAgICBjYXNlICdub3RjaCc6XG4gICAgICBjYXNlICdhbGxwYXNzJzpcblxuICAgICAgIGlmKGdhaW4gIT0gMS4wKSB7XG4gICAgICAgICBjb2Vmcy5iMCAqPSBnYWluO1xuICAgICAgICAgY29lZnMuYjEgKj0gZ2FpbjtcbiAgICAgICAgIGNvZWZzLmIyICo9IGdhaW47XG4gICAgICAgfVxuXG4gICAgICAgYnJlYWs7XG5cbiAgICAgIC8qIGdhaW4gaXMgYWxyZWFkeSBpbnRlZ3JhdGVkIGZvciB0aGUgZm9sbG93aW5nICovXG4gICAgICBjYXNlICdwZWFraW5nJzpcbiAgICAgIGNhc2UgJ2xvd3NoZWxmJzpcbiAgICAgIGNhc2UgJ2hpZ2hzaGVsZic6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICB9XG5cbi8qIGRpcmVjdCBmb3JtIEkgKi9cbi8qIGEwID0gMSwgYTEgPSBhWzBdLCBhMiA9IGFbMV0gKi9cbi8qIDQgc3RhdGVzIChpbiB0aGF0IG9yZGVyKTogeChuLTEpLCB4KG4tMiksIHkobi0xKSwgeShuLTIpICAqL1xuZnVuY3Rpb24gYmlxdWFkQXJyYXlEZjEoY29lZnMsIHN0YXRlLCBpbkZyYW1lLCBvdXRGcmFtZSwgc2l6ZSkge1xuICBmb3IobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgdmFyIHkgPSBjb2Vmcy5iMCAqIGluRnJhbWVbaV0gKyBjb2Vmcy5iMSAqIHN0YXRlLnhuXzFbaV0gKyBjb2Vmcy5iMiAqIHN0YXRlLnhuXzJbaV0gLSBjb2Vmcy5hMSAqIHN0YXRlLnluXzFbaV0gLSBjb2Vmcy5hMiAqIHN0YXRlLnluXzJbaV07XG5cbiAgICBvdXRGcmFtZVtpXSA9IHk7XG5cbiAgICAvLyB1cGRhdGUgc3RhdGVzXG4gICAgc3RhdGUueG5fMltpXSA9IHN0YXRlLnhuXzFbaV07XG4gICAgc3RhdGUueG5fMVtpXSA9IGluRnJhbWVbaV07XG5cbiAgICBzdGF0ZS55bl8yW2ldID0gc3RhdGUueW5fMVtpXTtcbiAgICBzdGF0ZS55bl8xW2ldID0geTtcbiAgfVxufVxuXG4vKiB0cmFuc3Bvc2VkIGRpcmVjdCBmb3JtIElJICovXG4vKiBhMCA9IDEsIGExID0gYVswXSwgYTIgPSBhWzFdICovXG4vKiAyIHN0YXRlcyAqL1xuZnVuY3Rpb24gYmlxdWFkQXJyYXlEZjIoY29lZnMsIHN0YXRlLCBpbkZyYW1lLCBvdXRGcmFtZSwgc2l6ZSkge1xuICBmb3IobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgb3V0RnJhbWVbaV0gPSBjb2Vmcy5iMCAqIGluRnJhbWVbaV0gKyBzdGF0ZS54bl8xW2ldO1xuXG4gICAgLy8gdXBkYXRlIHN0YXRlc1xuICAgIHN0YXRlLnhuXzFbaV0gPSBjb2Vmcy5iMSAqIGluRnJhbWVbaV0gLSBjb2Vmcy5hMVtpXSAqIG91dEZyYW1lW2ldICsgc3RhdGUueG5fMltpXTtcbiAgICBzdGF0ZS54bl8yW2ldID0gY29lZnMuYjIgKiBpbkZyYW1lW2ldIC0gY29lZnMuYTJbaV0gKiBvdXRGcmFtZVtpXTtcbiAgfVxufVxuXG5jbGFzcyBCaXF1YWQgZXh0ZW5kcyBMZm8ge1xuXG4gIGNvbnN0cnVjdG9yKHByZXZpb3VzLCBvcHRpb25zKSB7XG4gICAgdmFyIGRlZmF1bHRzID0ge1xuICAgICAgZmlsdGVyVHlwZTonbG93cGFzcycsXG4gICAgICBmMDogMS4wLFxuICAgICAgZ2FpbjogMS4wLFxuICAgICAgcTogMS4wXG4gICAgfTtcblxuICAgIHN1cGVyKHByZXZpb3VzLCBvcHRpb25zLCBkZWZhdWx0cyk7XG4gICAgdGhpcy50eXBlID0gJ2JpcXVhZCc7XG5cbiAgICAvLyBmcm9tIGhlcmUgb24gb3B0aW9ucyBpcyB0aGlzLnBhcmFtc1xuXG4gICAgLy8gdG8gaW1wbGVtZW50XG4gICAgLy8gaWYob3B0cy5kYW1wKSDigKZcbiAgICAvLyBpZihvcHRzLmRlY2F5KSDigKZcbiAgICAvLyBpZihvcHRzLm92ZXIpIOKAplxuXG4gICAgdmFyIGZyYW1lUmF0ZSA9IHRoaXMuc3RyZWFtUGFyYW1zLmZyYW1lUmF0ZTtcbiAgICAvLyBpZiBubyBmcmFtZVJhdGUgb3IgZnJhbWVyYXRlIGlzIDAgd2Ugc2hhbGwgaGFsdCFcbiAgICBpZighZnJhbWVSYXRlIHx8IGZyYW1lUmF0ZSA8PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgT3BlcmF0b3IgcmVxdWlyZXMgYSBmcmFtZVJhdGUgaGlnaGVyIHRoYW4gMC4nKTtcblxuICAgIHZhciBub3JtRjAgPSB0aGlzLnBhcmFtcy5mMCAvIGZyYW1lUmF0ZSxcbiAgICAgICAgZ2FpbiA9IHRoaXMucGFyYW1zLmdhaW4sXG4gICAgICAgIHE7XG5cbiAgICBpZih0aGlzLnBhcmFtcy5xKSAgcSA9IHRoaXMucGFyYW1zLnE7XG4gICAgaWYodGhpcy5wYXJhbXMuYncpIHEgPSB0aGlzLnBhcmFtcy5mMCAvIHRoaXMucGFyYW1zLmJ3O1xuXG4gICAgdGhpcy5jb2VmcyA9IHtcbiAgICAgIGIwOiAwLFxuICAgICAgYjE6IDAsXG4gICAgICBiMjogMCxcbiAgICAgIGExOiAwLFxuICAgICAgYTI6IDBcbiAgICB9O1xuXG4gICAgdmFyIGZyYW1lU2l6ZSA9IHRoaXMuc3RyZWFtUGFyYW1zLmZyYW1lU2l6ZTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgeG5fMTogbmV3IEZsb2F0MzJBcnJheShmcmFtZVNpemUpLFxuICAgICAgeG5fMjogbmV3IEZsb2F0MzJBcnJheShmcmFtZVNpemUpLFxuICAgICAgeW5fMTogbmV3IEZsb2F0MzJBcnJheShmcmFtZVNpemUpLFxuICAgICAgeW5fMjogbmV3IEZsb2F0MzJBcnJheShmcmFtZVNpemUpXG4gICAgfTtcblxuICAgIGNhbGN1bGF0ZUNvZWZzKHRoaXMucGFyYW1zLmZpbHRlclR5cGUsIG5vcm1GMCwgcSwgZ2FpbiwgdGhpcy5jb2Vmcyk7XG4gICAgdGhpcy5zZXR1cFN0cmVhbSgpO1xuICB9XG5cbiAgcHJvY2Vzcyh0aW1lLCBmcmFtZSkge1xuICAgIGJpcXVhZEFycmF5RGYxKHRoaXMuY29lZnMsIHRoaXMuc3RhdGUsIGZyYW1lLCB0aGlzLm91dEZyYW1lLCBmcmFtZS5sZW5ndGgpO1xuICAgIHRoaXMub3V0cHV0KHRpbWUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGZhY3RvcnkocHJldmlvdXMsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIG5ldyBCaXF1YWQocHJldmlvdXMsIG9wdGlvbnMpO1xufVxuZmFjdG9yeS5CaXF1YWQgPSBCaXF1YWQ7XG5cbm1vZHVsZS5leHBvcnRzID0gZmFjdG9yeTtcblxuIl19