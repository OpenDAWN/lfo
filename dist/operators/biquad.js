"use strict";

var _classCallCheck = require("babel-runtime/helpers/class-call-check")["default"];

var _inherits = require("babel-runtime/helpers/inherits")["default"];

var _get = require("babel-runtime/helpers/get")["default"];

var _createClass = require("babel-runtime/helpers/create-class")["default"];

var _core = require("babel-runtime/core-js")["default"];

/**
 * @fileoverview WAVE LFO module: biquad filter.
 * @author Jean-Philippe.Lambert@ircam.fr, Norbert.Schnell@ircam.fr, victor.saiz@ircam.fr
 * @version 0.1.0
 *
 * @brief  Biquad filter and coefficients calculator
 *
 * Based on the "Cookbook formulae for audio EQ biquad filter
 * coefficients" by Robert Bristow-Johnson
 *
 */

/* y(n) = b0 x(n) + b1 x(n-1) + b2 x(n-2)  */
/*                - a1 x(n-1) - a2 x(n-2)  */

/* f0 is normalised by the nyquist frequency */
/* q must be > 0. */
/* gain must be > 0. and is linear */

/* when there is no gain parameter, one can simply multiply the b
 * coefficients by a (linear) gain */

/* a0 is always 1. as each coefficient is normalised by a0, including a0 */

/* a1 is a[0] and a2 is a[1] */

var Lfo = require("../core/lfo-base");

var sin = Math.sin;
var cos = Math.cos;
var M_PI = Math.PI;
var sqrt = Math.sqrt;

// coefs calculations
// ------------------

/* LPF: H(s) = 1 / (s^2 + s/Q + 1) */
function lowpass_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = (1 - c) * 0.5 * a0_inv;
  coefs.b1 = (1 - c) * a0_inv;
  coefs.b2 = coefs.b0;
}

/* HPF: H(s) = s^2 / (s^2 + s/Q + 1) */
function highpass_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = (1 + c) * 0.5 * a0_inv;
  coefs.b1 = (-1 - c) * a0_inv;
  coefs.b2 = coefs.b0;
}

/* BPF: H(s) = s / (s^2 + s/Q + 1)  (constant skirt gain, peak gain = Q) */
function bandpass_constant_skirt_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var s = sin(w0);
  var alpha = s / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = s * 0.5 * a0_inv;
  coefs.b1 = 0;
  coefs.b2 = -coefs.b0;
}

/* BPF: H(s) = (s/Q) / (s^2 + s/Q + 1)      (constant 0 dB peak gain) */
function bandpass_constant_peak_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = alpha * a0_inv;
  coefs.b1 = 0;
  coefs.b2 = -coefs.b0;
}

/* notch: H(s) = (s^2 + 1) / (s^2 + s/Q + 1) */
function notch_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = a0_inv;
  coefs.b1 = coefs.a1;
  coefs.b2 = coefs.b0;
}

/* APF: H(s) = (s^2 - s/Q + 1) / (s^2 + s/Q + 1) */
function allpass_coefs(f0, q, coefs) {

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha) * a0_inv;

  coefs.b0 = coefs.a2;
  coefs.b1 = coefs.a1;
  coefs.b2 = 1;
}

/* peakingEQ: H(s) = (s^2 + s*(A/Q) + 1) / (s^2 + s/(A*Q) + 1) */
/* A = sqrt( 10^(dBgain/20) ) = 10^(dBgain/40) */
/* gain is linear here */
function peaking_coefs(f0, q, gain, coefs) {

  var g = sqrt(gain);
  var g_inv = 1 / g;

  var w0 = M_PI * f0;
  var alpha = sin(w0) / (2 * q);
  var c = cos(w0);

  var a0_inv = 1 / (1 + alpha * g_inv);

  coefs.a1 = -2 * c * a0_inv;
  coefs.a2 = (1 - alpha * g_inv) * a0_inv;

  coefs.b0 = (1 + alpha * g) * a0_inv;
  coefs.b1 = coefs.a1;
  coefs.b2 = (1 - alpha * g) * a0_inv;
}

/* lowShelf: H(s) = A * (s^2 + (sqrt(A)/Q)*s + A)/(A*s^2 + (sqrt(A)/Q)*s + 1) */
/* A = sqrt( 10^(dBgain/20) ) = 10^(dBgain/40) */
/* gain is linear here */
function lowshelf_coefs(f0, q, gain, coefs) {

  var g = sqrt(gain);

  var w0 = M_PI * f0;
  var alpha_2_sqrtg = sin(w0) * sqrt(g) / q;
  var c = cos(w0);

  var a0_inv = 1 / (g + 1 + (g - 1) * c + alpha_2_sqrtg);

  coefs.a1 = -2 * (g - 1 + (g + 1) * c) * a0_inv;
  coefs.a2 = (g + 1 + (g - 1) * c - alpha_2_sqrtg) * a0_inv;

  coefs.b0 = g * (g + 1 - (g - 1) * c + alpha_2_sqrtg) * a0_inv;
  coefs.b1 = 2 * g * (g - 1 - (g + 1) * c) * a0_inv;
  coefs.b2 = g * (g + 1 - (g - 1) * c - alpha_2_sqrtg) * a0_inv;
}

/* highShelf: H(s) = A * (A*s^2 + (sqrt(A)/Q)*s + 1)/(s^2 + (sqrt(A)/Q)*s + A) */
/* A = sqrt( 10^(dBgain/20) ) = 10^(dBgain/40) */
/* gain is linear here */
function highshelf_coefs(f0, q, gain, coefs) {

  var g = sqrt(gain);

  var w0 = M_PI * f0;
  var alpha_2_sqrtg = sin(w0) * sqrt(g) / q;
  var c = cos(w0);

  var a0_inv = 1 / (g + 1 - (g - 1) * c + alpha_2_sqrtg);

  coefs.a1 = 2 * (g - 1 - (g + 1) * c) * a0_inv;
  coefs.a2 = (g + 1 - (g - 1) * c - alpha_2_sqrtg) * a0_inv;

  coefs.b0 = g * (g + 1 + (g - 1) * c + alpha_2_sqrtg) * a0_inv;
  coefs.b1 = -2 * g * (g - 1 + (g + 1) * c) * a0_inv;
  coefs.b2 = g * (g + 1 + (g - 1) * c - alpha_2_sqrtg) * a0_inv;
}

/* helper */
function calculateCoefs(type, f0, q, gain, coefs) {

  switch (type) {
    case "lowpass":
      lowpass_coefs(f0, q, coefs);
      break;

    case "highpass":
      highpass_coefs(f0, q, coefs);
      break;

    case "bandpass_constant_skirt":
      bandpass_constant_skirt_coefs(f0, q, coefs);
      break;

    case "bandpass_constant_peak":
      bandpass_constant_peak_coefs(f0, q, coefs);
      break;

    case "notch":
      notch_coefs(f0, q, coefs);
      break;

    case "allpass":
      allpass_coefs(f0, q, coefs);
      break;

    case "peaking":
      peaking_coefs(f0, q, gain, coefs);
      break;

    case "lowshelf":
      lowshelf_coefs(f0, q, gain, coefs);
      break;

    case "highshelf":
      highshelf_coefs(f0, q, gain, coefs);
      break;
  }

  switch (type) {
    case "lowpass":
    case "highpass":
    case "bandpass_constant_skirt":
    case "bandpass_constant_peak":
    case "notch":
    case "allpass":

      if (gain != 1) {
        coefs.b0 *= gain;
        coefs.b1 *= gain;
        coefs.b2 *= gain;
      }

      break;

    /* gain is already integrated for the following */
    case "peaking":
    case "lowshelf":
    case "highshelf":
      break;
  }
}

/* direct form I */
/* a0 = 1, a1 = a[0], a2 = a[1] */
/* 4 states (in that order): x(n-1), x(n-2), y(n-1), y(n-2)  */
function biquadArrayDf1(coefs, state, inFrame, outFrame, size) {
  for (var i = 0; i < size; i++) {
    var y = coefs.b0 * inFrame[i] + coefs.b1 * state.xn_1[i] + coefs.b2 * state.xn_2[i] - coefs.a1 * state.yn_1[i] - coefs.a2 * state.yn_2[i];

    outFrame[i] = y;

    // update states
    state.xn_2[i] = state.xn_1[i];
    state.xn_1[i] = inFrame[i];

    state.yn_2[i] = state.yn_1[i];
    state.yn_1[i] = y;
  }
}

/* transposed direct form II */
/* a0 = 1, a1 = a[0], a2 = a[1] */
/* 2 states */
function biquadArrayDf2(coefs, state, inFrame, outFrame, size) {
  for (var i = 0; i < size; i++) {
    outFrame[i] = coefs.b0 * inFrame[i] + state.xn_1[i];

    // update states
    state.xn_1[i] = coefs.b1 * inFrame[i] - coefs.a1[i] * outFrame[i] + state.xn_2[i];
    state.xn_2[i] = coefs.b2 * inFrame[i] - coefs.a2[i] * outFrame[i];
  }
}

var Biquad = (function (_Lfo) {
  function Biquad(previous, options) {
    _classCallCheck(this, Biquad);

    var defaults = {
      filterType: "lowpass",
      f0: 1,
      gain: 1,
      q: 1
    };

    _get(_core.Object.getPrototypeOf(Biquad.prototype), "constructor", this).call(this, previous, options, defaults);
    this.type = "biquad";

    // from here on options is this.params

    // to implement
    // if(opts.damp) …
    // if(opts.decay) …
    // if(opts.over) …

    var frameRate = this.streamParams.frameRate;
    // if no frameRate or framerate is 0 we shall halt!
    if (!frameRate || frameRate <= 0) {
      throw new Error("This Operator requires a frameRate higher than 0.");
    }

    var normF0 = this.params.f0 / frameRate,
        gain = this.params.gain,
        q;

    if (this.params.q) {
      q = this.params.q;
    }
    if (this.params.bw) {
      q = this.params.f0 / this.params.bw;
    }

    this.coefs = {
      b0: 0,
      b1: 0,
      b2: 0,
      a1: 0,
      a2: 0
    };

    var frameSize = this.streamParams.frameSize;
    this.state = {
      xn_1: new Float32Array(frameSize),
      xn_2: new Float32Array(frameSize),
      yn_1: new Float32Array(frameSize),
      yn_2: new Float32Array(frameSize)
    };

    calculateCoefs(this.params.filterType, normF0, q, gain, this.coefs);
    this.setupStream();
  }

  _inherits(Biquad, _Lfo);

  _createClass(Biquad, {
    process: {
      value: function process(time, frame) {
        biquadArrayDf1(this.coefs, this.state, frame, this.outFrame, frame.length);
        this.output(time);
      }
    }
  });

  return Biquad;
})(Lfo);

function factory(previous, options) {
  return new Biquad(previous, options);
}
factory.Biquad = Biquad;

module.exports = factory;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVzNi9vcGVyYXRvcnMvYmlxdWFkLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBNEJBLElBQUksR0FBRyxHQUFHLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDOztBQUV0QyxJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDO0FBQ25CLElBQUksR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUM7QUFDbkIsSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQztBQUNuQixJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDOzs7Ozs7QUFNckIsU0FBUyxhQUFhLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUU7O0FBRWpDLE1BQUksRUFBRSxHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7QUFDbkIsTUFBSSxLQUFLLEdBQUcsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUcsR0FBRyxDQUFDLENBQUEsQUFBQyxDQUFDO0FBQ2hDLE1BQUksQ0FBQyxHQUFHLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQzs7QUFFaEIsTUFBSSxNQUFNLEdBQUcsQ0FBRyxJQUFJLENBQUcsR0FBRyxLQUFLLENBQUEsQUFBQyxDQUFDOztBQUVqQyxPQUFLLENBQUMsRUFBRSxHQUFHLEFBQUMsQ0FBQyxDQUFHLEdBQUcsQ0FBQyxHQUFJLE1BQU0sQ0FBQztBQUMvQixPQUFLLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBRyxHQUFHLEtBQUssQ0FBQSxHQUFJLE1BQU0sQ0FBQzs7QUFFbEMsT0FBSyxDQUFDLEVBQUUsR0FBRyxBQUFDLENBQUMsQ0FBRyxHQUFHLENBQUMsQ0FBQSxHQUFJLEdBQUcsR0FBSSxNQUFNLENBQUM7QUFDdEMsT0FBSyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUcsR0FBRyxDQUFDLENBQUEsR0FBSSxNQUFNLENBQUM7QUFDOUIsT0FBSyxD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QTJEeEIsU0FBUyxPQUFPLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRTtBQUNsQyxTQUFPLElBQUksTUFBTSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztDQUN0QztBQUNELE9BQU8sQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDOztBQUV4QixNQUFNLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyIsImZpbGUiOiJlczYvb3BlcmF0b3JzL2JpcXVhZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgV0FWRSBMRk8gbW9kdWxlOiBiaXF1YWQgZmlsdGVyLlxuICogQGF1dGhvciBKZWFuLVBoaWxpcHBlLkxhbWJlcnRAaXJjYW0uZnIsIE5vcmJlcnQuU2NobmVsbEBpcmNhbS5mciwgdmljdG9yLnNhaXpAaXJjYW0uZnJcbiAqIEB2ZXJzaW9uIDAuMS4wXG4gKlxuICogQGJyaWVmICBCaXF1YWQgZmlsdGVyIGFuZCBjb2VmZmljaWVudHMgY2FsY3VsYXRvclxuICpcbiAqIEJhc2VkIG9uIHRoZSBcIkNvb2tib29rIGZvcm11bGFlIGZvciBhdWRpbyBFUSBiaXF1YWQgZmlsdGVyXG4gKiBjb2VmZmljaWVudHNcIiBieSBSb2JlcnQgQnJpc3Rvdy1Kb2huc29uXG4gKlxuICovXG5cbi8qIHkobikgPSBiMCB4KG4pICsgYjEgeChuLTEpICsgYjIgeChuLTIpICAqL1xuLyogICAgICAgICAgICAgICAgLSBhMSB4KG4tMSkgLSBhMiB4KG4tMikgICovXG5cbi8qIGYwIGlzIG5vcm1hbGlzZWQgYnkgdGhlIG55cXVpc3QgZnJlcXVlbmN5ICovXG4vKiBxIG11c3QgYmUgPiAwLiAqL1xuLyogZ2FpbiBtdXN0IGJlID4gMC4gYW5kIGlzIGxpbmVhciAqL1xuXG4vKiB3aGVuIHRoZXJlIGlzIG5vIGdhaW4gcGFyYW1ldGVyLCBvbmUgY2FuIHNpbXBseSBtdWx0aXBseSB0aGUgYlxuICogY29lZmZpY2llbnRzIGJ5IGEgKGxpbmVhcikgZ2FpbiAqL1xuXG4vKiBhMCBpcyBhbHdheXMgMS4gYXMgZWFjaCBjb2VmZmljaWVudCBpcyBub3JtYWxpc2VkIGJ5IGEwLCBpbmNsdWRpbmcgYTAgKi9cblxuLyogYTEgaXMgYVswXSBhbmQgYTIgaXMgYVsxXSAqL1xuXG52YXIgTGZvID0gcmVxdWlyZSgnLi4vY29yZS9sZm8tYmFzZScpO1xuXG52YXIgc2luID0gTWF0aC5zaW47XG52YXIgY29zID0gTWF0aC5jb3M7XG52YXIgTV9QSSA9IE1hdGguUEk7XG52YXIgc3FydCA9IE1hdGguc3FydDtcblxuICAvLyBjb2VmcyBjYWxjdWxhdGlvbnNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLyogTFBGOiBIKHMpID0gMSAvIChzXjIgKyBzL1EgKyAxKSAqL1xuZnVuY3Rpb24gbG93cGFzc19jb2VmcyhmMCwgcSwgY29lZnMpIHtcblxuICAgIHZhciB3MCA9IE1fUEkgKiBmMDtcbiAgICB2YXIgYWxwaGEgPSBzaW4odzApIC8gKDIuMCAqIHEpO1xuICAgIHZhciBjID0gY29zKHcwKTtcblxuICAgIHZhciBhMF9pbnYgPSAxLjAgLyAoMS4wICsgYWxwaGEpO1xuXG4gICAgY29lZnMuYTEgPSAoLTIuMCAqIGMpICogYTBfaW52O1xuICAgIGNvZWZzLmEyID0gKDEuMCAtIGFscGhhKSAqIGEwX2ludjtcblxuICAgIGNvZWZzLmIwID0gKCgxLjAgLSBjKSAqIDAuNSkgKiBhMF9pbnY7XG4gICAgY29lZnMuYjEgPSAoMS4wIC0gYykgKiBhMF9pbnY7XG4gICAgY29lZnMuYjIgPSBjb2Vmcy5iMDtcblxuICB9XG5cbiAgLyogSFBGOiBIKHMpID0gc14yIC8gKHNeMiArIHMvUSArIDEpICovXG5mdW5jdGlvbiBoaWdocGFzc19jb2VmcyhmMCwgcSwgY29lZnMpIHtcblxuICAgIHZhciB3MCA9IE1fUEkgKiBmMDtcbiAgICB2YXIgYWxwaGEgPSBzaW4odzApIC8gKDIuMCAqIHEpO1xuICAgIHZhciBjID0gY29zKHcwKTtcblxuICAgIHZhciBhMF9pbnYgPSAxLjAgLyAoMS4wICsgYWxwaGEpO1xuXG4gICAgY29lZnMuYTEgPSAoLTIuMCAqIGMpICogYTBfaW52O1xuICAgIGNvZWZzLmEyID0gKDEuMCAtIGFscGhhKSAqIGEwX2ludjtcblxuICAgIGNvZWZzLmIwID0gKCgxLjAgKyBjKSAqIDAuNSkgKiBhMF9pbnY7XG4gICAgY29lZnMuYjEgPSAoLTEuMCAtIGMpICogYTBfaW52O1xuICAgIGNvZWZzLmIyID0gY29lZnMuYjA7XG5cbiAgfVxuXG4gIC8qIEJQRjogSChzKSA9IHMgLyAoc14yICsgcy9RICsgMSkgIChjb25zdGFudCBza2lydCBnYWluLCBwZWFrIGdhaW4gPSBRKSAqL1xuZnVuY3Rpb24gYmFuZHBhc3NfY29uc3RhbnRfc2tpcnRfY29lZnMoZjAsIHEsIGNvZWZzKSB7XG5cbiAgICB2YXIgdzAgPSBNX1BJICogZjA7XG4gICAgdmFyIHMgPSBzaW4odzApO1xuICAgIHZhciBhbHBoYSA9IHMgLyAoMi4wICogcSk7XG4gICAgdmFyIGMgPSBjb3ModzApO1xuXG4gICAgdmFyIGEwX2ludiA9IDEuMCAvICgxLjAgKyBhbHBoYSk7XG5cbiAgICBjb2Vmcy5hMSA9ICgtMi4wICogYykgKiBhMF9pbnY7XG4gICAgY29lZnMuYTIgPSAoMS4wIC0gYWxwaGEpICogYTBfaW52O1xuXG4gICAgY29lZnMuYjAgPSAocyAqIDAuNSkgKiBhMF9pbnY7XG4gICAgY29lZnMuYjEgPSAwLjA7XG4gICAgY29lZnMuYjIgPSAtY29lZnMuYjA7XG5cbiAgfVxuXG4gIC8qIEJQRjogSChzKSA9IChzL1EpIC8gKHNeMiArIHMvUSArIDEpICAgICAgKGNvbnN0YW50IDAgZEIgcGVhayBnYWluKSAqL1xuZnVuY3Rpb24gYmFuZHBhc3NfY29uc3RhbnRfcGVha19jb2VmcyhmMCwgcSwgY29lZnMpIHtcblxuICAgIHZhciB3MCA9IE1fUEkgKiBmMDtcbiAgICB2YXIgYWxwaGEgPSBzaW4odzApIC8gKDIuMCAqIHEpO1xuICAgIHZhciBjID0gY29zKHcwKTtcblxuICAgIHZhciBhMF9pbnYgPSAxLjAgLyAoMS4wICsgYWxwaGEpO1xuXG4gICAgY29lZnMuYTEgPSAoLTIuMCAqIGMpICogYTBfaW52O1xuICAgIGNvZWZzLmEyID0gKDEuMCAtIGFscGhhKSAqIGEwX2ludjtcblxuICAgIGNvZWZzLmIwID0gYWxwaGEgKiBhMF9pbnY7XG4gICAgY29lZnMuYjEgPSAwLjA7XG4gICAgY29lZnMuYjIgPSAtY29lZnMuYjA7XG4gIH1cblxuICAvKiBub3RjaDogSChzKSA9IChzXjIgKyAxKSAvIChzXjIgKyBzL1EgKyAxKSAqL1xuZnVuY3Rpb24gbm90Y2hfY29lZnMoZjAsIHEsIGNvZWZzKSB7XG5cbiAgICB2YXIgdzAgPSBNX1BJICogZjA7XG4gICAgdmFyIGFscGhhID0gc2luKHcwKSAvICgyLjAgKiBxKTtcbiAgICB2YXIgYyA9IGNvcyh3MCk7XG5cbiAgICB2YXIgYTBfaW52ID0gMS4wIC8gKDEuMCArIGFscGhhKTtcblxuICAgIGNvZWZzLmExID0gKC0yLjAgKiBjKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5hMiA9ICgxLjAgLSBhbHBoYSkgKiBhMF9pbnY7XG5cbiAgICBjb2Vmcy5iMCA9IGEwX2ludjtcbiAgICBjb2Vmcy5iMSA9IGNvZWZzLmExO1xuICAgIGNvZWZzLmIyID0gY29lZnMuYjA7XG5cbiAgfVxuXG4gIC8qIEFQRjogSChzKSA9IChzXjIgLSBzL1EgKyAxKSAvIChzXjIgKyBzL1EgKyAxKSAqL1xuZnVuY3Rpb24gYWxscGFzc19jb2VmcyhmMCwgcSwgY29lZnMpIHtcblxuICAgIHZhciB3MCA9IE1fUEkgKiBmMDtcbiAgICB2YXIgYWxwaGEgPSBzaW4odzApIC8gKDIuMCAqIHEpO1xuICAgIHZhciBjID0gY29zKHcwKTtcblxuICAgIHZhciBhMF9pbnYgPSAxLjAgLyAoMS4wICsgYWxwaGEpO1xuXG4gICAgY29lZnMuYTEgPSAoLTIuMCAqIGMpICogYTBfaW52O1xuICAgIGNvZWZzLmEyID0gKDEuMCAtIGFscGhhKSAqIGEwX2ludjtcblxuICAgIGNvZWZzLmIwID0gY29lZnMuYTI7XG4gICAgY29lZnMuYjEgPSBjb2Vmcy5hMTtcbiAgICBjb2Vmcy5iMiA9IDEuMDtcblxuICB9XG5cbiAgLyogcGVha2luZ0VROiBIKHMpID0gKHNeMiArIHMqKEEvUSkgKyAxKSAvIChzXjIgKyBzLyhBKlEpICsgMSkgKi9cbiAgLyogQSA9IHNxcnQoIDEwXihkQmdhaW4vMjApICkgPSAxMF4oZEJnYWluLzQwKSAqL1xuICAvKiBnYWluIGlzIGxpbmVhciBoZXJlICovXG5mdW5jdGlvbiBwZWFraW5nX2NvZWZzKGYwLCBxLCBnYWluLCBjb2Vmcykge1xuXG4gICAgdmFyIGcgPSBzcXJ0KGdhaW4pO1xuICAgIHZhciBnX2ludiA9IDEuMCAvIGc7XG5cbiAgICB2YXIgdzAgPSBNX1BJICogZjA7XG4gICAgdmFyIGFscGhhID0gc2luKHcwKSAvICgyLjAgKiBxKTtcbiAgICB2YXIgYyA9IGNvcyh3MCk7XG5cbiAgICB2YXIgYTBfaW52ID0gMS4wIC8gKDEuMCArIGFscGhhICogZ19pbnYpO1xuXG4gICAgY29lZnMuYTEgPSAoLTIuMCAqIGMpICogYTBfaW52O1xuICAgIGNvZWZzLmEyID0gKDEuMCAtIGFscGhhICogZ19pbnYpICogYTBfaW52O1xuXG4gICAgY29lZnMuYjAgPSAoMS4wICsgYWxwaGEgKiBnKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5iMSA9IGNvZWZzLmExO1xuICAgIGNvZWZzLmIyID0gKDEuMCAtIGFscGhhICogZykgKiBhMF9pbnY7XG5cbiAgfVxuXG4gIC8qIGxvd1NoZWxmOiBIKHMpID0gQSAqIChzXjIgKyAoc3FydChBKS9RKSpzICsgQSkvKEEqc14yICsgKHNxcnQoQSkvUSkqcyArIDEpICovXG4gIC8qIEEgPSBzcXJ0KCAxMF4oZEJnYWluLzIwKSApID0gMTBeKGRCZ2Fpbi80MCkgKi9cbiAgLyogZ2FpbiBpcyBsaW5lYXIgaGVyZSAqL1xuZnVuY3Rpb24gbG93c2hlbGZfY29lZnMoZjAsIHEsIGdhaW4sIGNvZWZzKSB7XG5cbiAgICB2YXIgZyA9IHNxcnQoZ2Fpbik7XG5cbiAgICB2YXIgdzAgPSBNX1BJICogZjA7XG4gICAgdmFyIGFscGhhXzJfc3FydGcgPSBzaW4odzApICogc3FydChnKSAvIHEgO1xuICAgIHZhciBjID0gY29zKHcwKTtcblxuICAgIHZhciBhMF9pbnYgPSAxLjAgLyAoIChnKzEuMCkgKyAoZy0xLjApICogYyArIGFscGhhXzJfc3FydGcpO1xuXG4gICAgY29lZnMuYTEgPSAoLTIuMCAqICAgICAoIChnLTEuMCkgKyAoZysxLjApICogYyAgICAgICAgICAgICAgICApICkgKiBhMF9pbnY7XG4gICAgY29lZnMuYTIgPSAoICAgICAgICAgICAgIChnKzEuMCkgKyAoZy0xLjApICogYyAtIGFscGhhXzJfc3FydGcgICkgKiBhMF9pbnY7XG5cbiAgICBjb2Vmcy5iMCA9ICggICAgICAgZyAqICggKGcrMS4wKSAtIChnLTEuMCkgKiBjICsgYWxwaGFfMl9zcXJ0ZykgKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5iMSA9ICggMi4wICogZyAqICggKGctMS4wKSAtIChnKzEuMCkgKiBjICAgICAgICAgICAgICAgICkgKSAqIGEwX2ludjtcbiAgICBjb2Vmcy5iMiA9ICggICAgICAgZyAqICggKGcrMS4wKSAtIChnLTEuMCkgKiBjIC0gYWxwaGFfMl9zcXJ0ZykgKSAqIGEwX2ludjtcblxuICB9XG5cbiAgLyogaGlnaFNoZWxmOiBIKHMpID0gQSAqIChBKnNeMiArIChzcXJ0KEEpL1EpKnMgKyAxKS8oc14yICsgKHNxcnQoQSkvUSkqcyArIEEpICovXG4gIC8qIEEgPSBzcXJ0KCAxMF4oZEJnYWluLzIwKSApID0gMTBeKGRCZ2Fpbi80MCkgKi9cbiAgLyogZ2FpbiBpcyBsaW5lYXIgaGVyZSAqL1xuZnVuY3Rpb24gaGlnaHNoZWxmX2NvZWZzKGYwLCBxLCBnYWluLCBjb2Vmcykge1xuXG4gICAgdmFyIGcgPSBzcXJ0KGdhaW4pO1xuXG4gICAgdmFyIHcwID0gTV9QSSAqIGYwO1xuICAgIHZhciBhbHBoYV8yX3NxcnRnID0gc2luKHcwKSAqIHNxcnQoZykgLyBxIDtcbiAgICB2YXIgYyA9IGNvcyh3MCk7XG5cbiAgICB2YXIgYTBfaW52ID0gMS4wIC8gKCAoZysxLjApIC0gKGctMS4wKSAqIGMgKyBhbHBoYV8yX3NxcnRnKTtcblxuICAgIGNvZWZzLmExID0gKCAyLjAgKiAgICAgKCAoZy0xLjApIC0gKGcrMS4wKSAqIGMgICAgICAgICAgICAgICAgKSApICogYTBfaW52O1xuICAgIGNvZWZzLmEyID0gKCAgICAgICAgICAgICAoZysxLjApIC0gKGctMS4wKSAqIGMgLSBhbHBoYV8yX3NxcnRnICApICogYTBfaW52O1xuXG4gICAgY29lZnMuYjAgPSAoICAgICAgZyAqICggIChnKzEuMCkgKyAoZy0xLjApICogYyArIGFscGhhXzJfc3FydGcpICkgKiBhMF9pbnY7XG4gICAgY29lZnMuYjEgPSAoLTIuMCAqIGcgKiAoIChnLTEuMCkgKyAoZysxLjApICogYyAgICAgICAgICAgICAgICApICkgKiBhMF9pbnY7XG4gICAgY29lZnMuYjIgPSAoICAgICAgZyAqICggIChnKzEuMCkgKyAoZy0xLjApICogYyAtIGFscGhhXzJfc3FydGcpICkgKiBhMF9pbnY7XG5cbiAgfVxuXG4gIC8qIGhlbHBlciAqL1xuZnVuY3Rpb24gY2FsY3VsYXRlQ29lZnModHlwZSwgZjAsIHEsIGdhaW4sIGNvZWZzKSB7XG5cbiAgICBzd2l0Y2godHlwZSkge1xuICAgICAgY2FzZSAnbG93cGFzcyc6XG4gICAgICAgIGxvd3Bhc3NfY29lZnMoZjAsIHEsIGNvZWZzKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ2hpZ2hwYXNzJzpcbiAgICAgICAgaGlnaHBhc3NfY29lZnMoZjAsIHEsIGNvZWZzKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ2JhbmRwYXNzX2NvbnN0YW50X3NraXJ0JzpcbiAgICAgICAgYmFuZHBhc3NfY29uc3RhbnRfc2tpcnRfY29lZnMoZjAsIHEsIGNvZWZzKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ2JhbmRwYXNzX2NvbnN0YW50X3BlYWsnOlxuICAgICAgICBiYW5kcGFzc19jb25zdGFudF9wZWFrX2NvZWZzKGYwLCBxLCBjb2Vmcyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdub3RjaCc6XG4gICAgICAgIG5vdGNoX2NvZWZzKGYwLCBxLCBjb2Vmcyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdhbGxwYXNzJzpcbiAgICAgICAgYWxscGFzc19jb2VmcyhmMCwgcSwgY29lZnMpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAncGVha2luZyc6XG4gICAgICAgIHBlYWtpbmdfY29lZnMoZjAsIHEsIGdhaW4sIGNvZWZzKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ2xvd3NoZWxmJzpcbiAgICAgICAgbG93c2hlbGZfY29lZnMoZjAsIHEsIGdhaW4sIGNvZWZzKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ2hpZ2hzaGVsZic6XG4gICAgICAgIGhpZ2hzaGVsZl9jb2VmcyhmMCwgcSwgZ2FpbiwgY29lZnMpO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgJ2xvd3Bhc3MnOlxuICAgICAgY2FzZSAnaGlnaHBhc3MnOlxuICAgICAgY2FzZSAnYmFuZHBhc3NfY29uc3RhbnRfc2tpcnQnOlxuICAgICAgY2FzZSAnYmFuZHBhc3NfY29uc3RhbnRfcGVhayc6XG4gICAgICBjYXNlICdub3RjaCc6XG4gICAgICBjYXNlICdhbGxwYXNzJzpcblxuICAgICAgIGlmIChnYWluICE9IDEuMCkge1xuICAgICAgICAgY29lZnMuYjAgKj0gZ2FpbjtcbiAgICAgICAgIGNvZWZzLmIxICo9IGdhaW47XG4gICAgICAgICBjb2Vmcy5iMiAqPSBnYWluO1xuICAgICAgIH1cblxuICAgICAgIGJyZWFrO1xuXG4gICAgICAvKiBnYWluIGlzIGFscmVhZHkgaW50ZWdyYXRlZCBmb3IgdGhlIGZvbGxvd2luZyAqL1xuICAgICAgY2FzZSAncGVha2luZyc6XG4gICAgICBjYXNlICdsb3dzaGVsZic6XG4gICAgICBjYXNlICdoaWdoc2hlbGYnOlxuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgfVxuXG4vKiBkaXJlY3QgZm9ybSBJICovXG4vKiBhMCA9IDEsIGExID0gYVswXSwgYTIgPSBhWzFdICovXG4vKiA0IHN0YXRlcyAoaW4gdGhhdCBvcmRlcik6IHgobi0xKSwgeChuLTIpLCB5KG4tMSksIHkobi0yKSAgKi9cbmZ1bmN0aW9uIGJpcXVhZEFycmF5RGYxKGNvZWZzLCBzdGF0ZSwgaW5GcmFtZSwgb3V0RnJhbWUsIHNpemUpIHtcbiAgZm9yKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgIHZhciB5ID0gY29lZnMuYjAgKiBpbkZyYW1lW2ldICsgY29lZnMuYjEgKiBzdGF0ZS54bl8xW2ldICsgY29lZnMuYjIgKiBzdGF0ZS54bl8yW2ldIC0gY29lZnMuYTEgKiBzdGF0ZS55bl8xW2ldIC0gY29lZnMuYTIgKiBzdGF0ZS55bl8yW2ldO1xuXG4gICAgb3V0RnJhbWVbaV0gPSB5O1xuXG4gICAgLy8gdXBkYXRlIHN0YXRlc1xuICAgIHN0YXRlLnhuXzJbaV0gPSBzdGF0ZS54bl8xW2ldO1xuICAgIHN0YXRlLnhuXzFbaV0gPSBpbkZyYW1lW2ldO1xuXG4gICAgc3RhdGUueW5fMltpXSA9IHN0YXRlLnluXzFbaV07XG4gICAgc3RhdGUueW5fMVtpXSA9IHk7XG4gIH1cbn1cblxuLyogdHJhbnNwb3NlZCBkaXJlY3QgZm9ybSBJSSAqL1xuLyogYTAgPSAxLCBhMSA9IGFbMF0sIGEyID0gYVsxXSAqL1xuLyogMiBzdGF0ZXMgKi9cbmZ1bmN0aW9uIGJpcXVhZEFycmF5RGYyKGNvZWZzLCBzdGF0ZSwgaW5GcmFtZSwgb3V0RnJhbWUsIHNpemUpIHtcbiAgZm9yKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgIG91dEZyYW1lW2ldID0gY29lZnMuYjAgKiBpbkZyYW1lW2ldICsgc3RhdGUueG5fMVtpXTtcblxuICAgIC8vIHVwZGF0ZSBzdGF0ZXNcbiAgICBzdGF0ZS54bl8xW2ldID0gY29lZnMuYjEgKiBpbkZyYW1lW2ldIC0gY29lZnMuYTFbaV0gKiBvdXRGcmFtZVtpXSArIHN0YXRlLnhuXzJbaV07XG4gICAgc3RhdGUueG5fMltpXSA9IGNvZWZzLmIyICogaW5GcmFtZVtpXSAtIGNvZWZzLmEyW2ldICogb3V0RnJhbWVbaV07XG4gIH1cbn1cblxuY2xhc3MgQmlxdWFkIGV4dGVuZHMgTGZvIHtcblxuICBjb25zdHJ1Y3RvcihwcmV2aW91cywgb3B0aW9ucykge1xuICAgIHZhciBkZWZhdWx0cyA9IHtcbiAgICAgIGZpbHRlclR5cGU6J2xvd3Bhc3MnLFxuICAgICAgZjA6IDEuMCxcbiAgICAgIGdhaW46IDEuMCxcbiAgICAgIHE6IDEuMFxuICAgIH07XG5cbiAgICBzdXBlcihwcmV2aW91cywgb3B0aW9ucywgZGVmYXVsdHMpO1xuICAgIHRoaXMudHlwZSA9ICdiaXF1YWQnO1xuXG4gICAgLy8gZnJvbSBoZXJlIG9uIG9wdGlvbnMgaXMgdGhpcy5wYXJhbXNcblxuICAgIC8vIHRvIGltcGxlbWVudFxuICAgIC8vIGlmKG9wdHMuZGFtcCkg4oCmXG4gICAgLy8gaWYob3B0cy5kZWNheSkg4oCmXG4gICAgLy8gaWYob3B0cy5vdmVyKSDigKZcblxuICAgIHZhciBmcmFtZVJhdGUgPSB0aGlzLnN0cmVhbVBhcmFtcy5mcmFtZVJhdGU7XG4gICAgLy8gaWYgbm8gZnJhbWVSYXRlIG9yIGZyYW1lcmF0ZSBpcyAwIHdlIHNoYWxsIGhhbHQhXG4gICAgaWYgKCFmcmFtZVJhdGUgfHwgZnJhbWVSYXRlIDw9IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVGhpcyBPcGVyYXRvciByZXF1aXJlcyBhIGZyYW1lUmF0ZSBoaWdoZXIgdGhhbiAwLicpO1xuICAgIH1cblxuICAgIHZhciBub3JtRjAgPSB0aGlzLnBhcmFtcy5mMCAvIGZyYW1lUmF0ZSxcbiAgICAgICAgZ2FpbiA9IHRoaXMucGFyYW1zLmdhaW4sXG4gICAgICAgIHE7XG5cbiAgICBpZiAodGhpcy5wYXJhbXMucSkgIHsgcSA9IHRoaXMucGFyYW1zLnE7IH1cbiAgICBpZiAodGhpcy5wYXJhbXMuYncpIHsgcSA9IHRoaXMucGFyYW1zLmYwIC8gdGhpcy5wYXJhbXMuYnc7IH1cblxuICAgIHRoaXMuY29lZnMgPSB7XG4gICAgICBiMDogMCxcbiAgICAgIGIxOiAwLFxuICAgICAgYjI6IDAsXG4gICAgICBhMTogMCxcbiAgICAgIGEyOiAwXG4gICAgfTtcblxuICAgIHZhciBmcmFtZVNpemUgPSB0aGlzLnN0cmVhbVBhcmFtcy5mcmFtZVNpemU7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHhuXzE6IG5ldyBGbG9hdDMyQXJyYXkoZnJhbWVTaXplKSxcbiAgICAgIHhuXzI6IG5ldyBGbG9hdDMyQXJyYXkoZnJhbWVTaXplKSxcbiAgICAgIHluXzE6IG5ldyBGbG9hdDMyQXJyYXkoZnJhbWVTaXplKSxcbiAgICAgIHluXzI6IG5ldyBGbG9hdDMyQXJyYXkoZnJhbWVTaXplKVxuICAgIH07XG5cbiAgICBjYWxjdWxhdGVDb2Vmcyh0aGlzLnBhcmFtcy5maWx0ZXJUeXBlLCBub3JtRjAsIHEsIGdhaW4sIHRoaXMuY29lZnMpO1xuICAgIHRoaXMuc2V0dXBTdHJlYW0oKTtcbiAgfVxuXG4gIHByb2Nlc3ModGltZSwgZnJhbWUpIHtcbiAgICBiaXF1YWRBcnJheURmMSh0aGlzLmNvZWZzLCB0aGlzLnN0YXRlLCBmcmFtZSwgdGhpcy5vdXRGcmFtZSwgZnJhbWUubGVuZ3RoKTtcbiAgICB0aGlzLm91dHB1dCh0aW1lKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBmYWN0b3J5KHByZXZpb3VzLCBvcHRpb25zKSB7XG4gIHJldHVybiBuZXcgQmlxdWFkKHByZXZpb3VzLCBvcHRpb25zKTtcbn1cbmZhY3RvcnkuQmlxdWFkID0gQmlxdWFkO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZhY3Rvcnk7XG5cbiJdfQ==